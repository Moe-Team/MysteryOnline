<LoginScreen>:
    username: username_input.text

    Image:
        source: "misc_img/MOTitle.png"
        pos_hint: {'center_y': 0.8, 'center_x': 0.5}

    BoxLayout:
        orientation: 'vertical'
        size_hint: None, None
        size: 300, 150
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        Label:
            text: "Username"
            font_size: 20
            outline_color: 0, 0, 0
            outline_width: 2

        TextInput:
            id: username_input
            on_text_validate: root.on_login_clicked()
            multiline: False
            text: app.config.get('other', 'last_username')

        Button:
            text: "Log in"
            on_release: root.on_login_clicked()

        Button:
            text: "Choose character"
            on_release: root.on_select_clicked()

        Button:
            text: "Settings"
            on_release: app.open_settings()


<LogLabel>:
    markup: True
    text_size: self.width, None
    size_hint_y: None
    height: self.texture_size[1]


<LogWindow>:
    grid_l: grid_l
    bar_width: 5
    bar_margin: 0
    scroll_type: ['content', 'bars']
    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size

    GridLayout:
        id: grid_l
        cols: 1
        size_hint_y: None
        size: root.size


<SpriteWindow>:
    background: background
    sprite_layout: sprite_layout

    Image:
        id: background
        size: root.size
        pos: root.pos

        StencilView:
            size: root.size
            pos: root.pos

            FloatLayout:
                id: sprite_layout
                size: root.size
                pos: root.pos


<MainTextInput>:
    readonly: True
    on_text_validate: self.send_message()


<MainScreen>:
    icons_layout: icons_layout
    sprite_window: sprite_window
    msg_input: msg_input
    toolbar: toolbar
    text_box: text_box
    log_window: log_window
    ooc_window: ooc_window
    left_tab: left_tab

    FloatLayout:

        SpriteWindow:
            id: sprite_window
            size_hint: None, None
            size: 800, 600
            pos_hint: {'center_x': 0.5, 'center_y': 0.52}

        TextBox:
            id: text_box
            size_hint: None, None
            size: 800, 170
            pos: sprite_window.x, sprite_window.y

        MainTextInput:
            id: msg_input
            multiline: False
            size_hint: None, None
            size: 800, 30
            pos: sprite_window.x, sprite_window.y - 35

        LogWindow:
            id: log_window
            size_hint: None, None
            x: sprite_window.right + 5
            top: sprite_window.top
            size: 250, 300

        OOCWindow:
            id: ooc_window
            size_hint: None, None
            size: 250, 330
            x: log_window.x
            top: log_window.y -5

        IconsLayout:
            id: icons_layout
            size_hint: None, None
            size: 250, 360
            right: sprite_window.x - 20
            y: sprite_window.y -30

        LeftTab:
            id: left_tab
            y: icons_layout.top + 5
            x: icons_layout.x
            size_hint: None, None
            size: 800 / 3, 300

        Toolbar:
            id: toolbar
            size_hint: None, None
            size: 800, 30
            pos: msg_input.x, msg_input.y - 30


<SpriteSettings>:
    check_flip_h: check_flip_h
    orientation: 'horizontal'

    Label:
        text: "Flip horizontally"

    CheckBox:
        id: check_flip_h
        on_active: root.on_checked_flip_h(self.active)


<TrackLabel>:
    size_hint: 1, None
    height: 30


<MusicList>:
    music_lay: music_lay
    text: "Music list"

    ScrollView:

        BoxLayout:
            id: music_lay
            orientation: 'vertical'
            size_hint_y: None


<LeftTab>:
    sprite_preview: sprite_preview
    sprite_settings: sprite_settings
    trans_slider: trans_slider
    speed_slider: speed_slider
    music_list: music_list
    do_default_tab: False
    tab_width: 80

    TabbedPanelItem:
        text: "Preview"

        BoxLayout:
            size: root.size
            pos: root.pos
            orientation: 'vertical'

            SpritePreview:
                id: sprite_preview
                size_hint: None, None
                size: 800 / 3, 600 / 3

            SpriteSettings:
                id: sprite_settings
                size_hint: None, None
                size: 800 / 3, 60

    TabbedPanelItem:
        text: "Other"

        BoxLayout:
            size: root.size
            pos: root.pos
            orientation: 'vertical'

            Label:
                text: "Textbox transparency"

            Slider:
                id: trans_slider
                min: 0
                max: 100
                on_value: root.on_trans_slider_value()

            Label:
                text: "Textbox speed"

            Slider:
                id: speed_slider
                min: 1
                max: 60
                on_value: root.on_speed_slider_value()

    MusicList:
        id: music_list


<IconsLayout>:

    BoxLayout:
        size_hint: 1, None
        height: 40

        Button:
            text: "<"
            on_release: root.prev_page()

        Button:
            text: ">"
            on_release: root.next_page()


<OOCLogLabel>:
    halign: 'left'
    valign: 'top'
    font_size: 16
    text_size: self.width, None
    size_hint_y: None
    height: self.texture_size[1]
    markup: True


<UserBoxPopup>:
    char_lbl: char_lbl
    sub_lbl: sub_lbl
    loc_lbl: loc_lbl

    size_hint: None, None
    size: 100, 100

    BoxLayout:
        orientation: 'vertical'

        Label:
            id: char_lbl

        Label:
            id: sub_lbl

        Label:
            id: loc_lbl


<UserBox>:
    lbl: lbl
    pm: pm
    mute: mute

    BoxLayout:
        orientation: 'horizontal'
        size: root.size
        pos: root.pos

        Label:
            id: lbl
            size_hint_y: None
            size_hint_x: 0.4
            height: 30

        Button:
            id: pm
            text: "PM"
            size_hint_x: 0.3
            size_hint_y: None
            height: 30

        Button:
            id: mute
            text: "Mute"
            size_hint_x: 0.3
            size_hint_y: None
            height: 30


<MusicTab>:
    url_input: url_input
    loop_checkbox: loop_checkbox
    text: 'Music'

    BoxLayout:
        orientation: 'vertical'

        Label:
            text: "Music URL"
            size_hint: 1, None
            height: 40

        TextInput:
            id: url_input
            multiline: False
            on_text_validate: root.on_music_play()
            size_hint: 1, None
            height: 30

        BoxLayout:
            size_hint: 1, None
            height: 40

            Button:
                text: "Play"
                on_release: root.on_music_play()
                size_hint: None, None
                height: 40

            Button:
                text: "Stop"
                on_release: root.music_stop()
                size_hint: None, None
                height: 40

        BoxLayout:
            size_hint: 1, None
            height: 40

            Label:
                text: 'Loop'

            CheckBox:
                id: loop_checkbox
                active: True
                on_active: self.on_loop()

        BoxLayout:
            size_hint: 1, None
            height: 40

            Button:
                text: "Reset music"
                on_release: root.reset_music()


<OOCWindow>:
    user_list: user_list
    ooc_chat_header: ooc_chat_header
    ooc_input: ooc_input
    blip_slider: blip_slider
    music_slider: music_slider
    music_tab: music_tab
    effect_slider: effect_slider
    chat_grid: chat_grid

    do_default_tab: False
    tab_width: 60

    TabbedPanelItem:
        text: 'OOC'
        id: ooc_chat_header

        BoxLayout:
            orientation: 'vertical'

            ScrollView:

                GridLayout:
                    id: chat_grid
                    cols: 1
                    size_hint_y: None

            TextInput:
                id: ooc_input
                size_hint: 1, None
                height: 30
                multiline: False
                on_text_validate: root.send_ooc()

    TabbedPanelItem:
        text: 'Online'

        ScrollView:

            GridLayout:
                size: 300, 300
                cols: 1
                spacing: 10
                size_hint_y: None
                id: user_list

    TabbedPanelItem:
        text: 'Volume'

        BoxLayout:
            orientation: 'vertical'

            Label:
                text: "Blips"
                size_hint: 1, None
                height: 30

            Slider:
                id: blip_slider
                size_hint: 1, 1
                min: 0
                max: 100
                on_value: root.on_slider_blip_value()

            Label:
                text: "Music"
                size_hint: 1, None
                height: 30

            Slider:
                id: music_slider
                size_hint: 1, 1
                min: 0
                max: 100
                on_value: root.on_slider_music_value()

            Label:
                text: "Sound effects"
                size_hint: 1, None
                height: 30

            Slider:
                id: effect_slider
                size_hint: 1, 1
                min: 0
                max: 100
                on_value: root.on_slider_effect_value()

    MusicTab:
        id: music_tab


<TextBox>:
    char_name: char_name
    font_size: 20
    text_size: self.size
    halign: 'left'
    valign: 'top'
    outline_color: [0, 0, 0]
    outline_width: 2
    padding: 10, 10

    Label:
        id: char_name
        pos: root.x, root.top
        size_hint: None, None
        size: 200, 30
        text_size: self.size
        halign: 'center'
        valign: 'top'
        font_size: 20
        outline_color: [0, 0, 0]
        outline_width: 2
        padding: 2, 2


<SpritePreview>:
    center_sprite: center_s

    StencilView:
        size: root.size
        pos: root.pos

        FloatLayout:
            size: root.size
            pos: root.pos

            Image:
                id: center_s
                opacity: 0
                size_hint: None, None
                size: 200, 200
                pos_hint: {'center_x': 0.5, 'y': 0}


<PrivateMessageScreen>:
    prv_users_scroll: prv_users_scroll
    pm_body: pm_body
    size_hint: 0.8, 0.8
    padding: 10, 10

    BoxLayout:
        orientation: 'horizontal'

        BoxLayout:
            orientation: 'vertical'

            ScrollView:
                size_hint: 0.8, 1

                Label:
                    id: pm_body
                    markup: True
                    text_size: self.width, None
                    size_hint_y: None
                    height: self.texture_size[1]

            TextInput:
                id: pm_input
                on_text_validate: root.send_pm()
                multiline: False
                height: 30
                size_hint: 1, None

        BoxLayout:
            size_hint: 0.2, 1
            orientation: 'vertical'
            id: pm_user_box

            ScrollView:
                valign: 'top'
                size_hint: 1, 0.8
                size: pm_user_box.width, pm_user_box.height
                title: 'User list'
                id: prv_users_scroll

                GridLayout:
                    cols: 1
                    spacing: 10
                    size_hint_y: None
                    size: pm_user_box.width, pm_user_box.height
                    id: prv_users_list

            Button:
                size_hint: 1, 0.2
                valign: 'bottom'
                text: 'Close'
                on_release: root.prv_chat_close_btn()
                id: prv_chat_btn


<RightClickMenu>:
    char_select: char_select
    size_hint: None, None
    size: 105, 300

    BoxLayout:
        orientation: 'vertical'

        Button:
            id: char_select
            size_hint: None, None
            size: 100, 30
            text: 'Character'
            on_release: root.on_char_select_clicked()

        Button:
            id: settings
            size_hint: None, None
            size: 100, 30
            text: 'Settings'
            on_release: root.on_settings_clicked()


<CharacterSelect>:
    button_lay: button_lay
    scroll_lay: scroll_lay

    title: 'Select your character'
    size_hint: 0.7, 0.7
    auto_dismiss: False
    background_color: [0, 0, 0, 0]

    FloatLayout:
        orientation: 'vertical'
        id: button_lay

        ScrollView:
            pos_hint: {'top': 1, 'x': 0}
            size_hint: 1, None
            height: root.height - 100
            scroll_type: ['content', 'bars']
            bar_width: 5
            id: scroll_lay


<MainScreenManager>:
    main_screen: main_screen

    LoginScreen:
        name: "login"
        id: login_screen
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: "misc_img\\loginBG.jpg"

    MainScreen:
        name: "main"
        id: main_screen
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: "misc_img\\background.jpg"